<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Prompts IA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .btn-copiar { background-color: #A3B8A0; border-color: #A3B8A0; color: white; }
        .btn-copiar:hover { background-color: #7a9177; border-color: #7a9177; color: white; }
        
        .btn-gemini { background-color: #005F6B; border-color: #005F6B; color: white; }
        .btn-gemini:hover { background-color: #003d45; border-color: #003d45; color: white; }
        
        .btn-chatgpt { background-color: #EAD2C2; border-color: #EAD2C2; color: #333; }
        .btn-chatgpt:hover { background-color: #dbb89e; border-color: #dbb89e; color: #222; }
        
        .btn-deepseek { background-color: #B86B5E; border-color: #B86B5E; color: white; }
        .btn-deepseek:hover { background-color: #954a3c; border-color: #954a3c; color: white; }
        
        .btn-claude { background-color: #D4A05D; border-color: #D4A05D; color: white; }
        .btn-claude:hover { background-color: #b8853a; border-color: #b8853a; color: white; }
        
        .btn-perplexity { background-color: #4A4A4A; border-color: #4A4A4A; color: white; }
        .btn-perplexity:hover { background-color: #2a2a2a; border-color: #2a2a2a; color: white; }
        
        .btn-manus { background-color: #F7F5F2; border-color: #F7F5F2; color: #333; }
        .btn-manus:hover { background-color: #e8e3dc; border-color: #e8e3dc; color: #222; }
        
        .upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: border-color 0.3s;
        }
        
        .upload-area:hover {
            border-color: #0d6efd;
        }
        
        .upload-area.dragover {
            border-color: #0d6efd;
            background-color: #f8f9fa;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <h1 class="mb-4 text-center">Gerador de Prompts para Resumos</h1>
        
        <!-- Seção de Upload de PDF -->
        <div class="card p-4 shadow-sm mb-4">
            <h5 class="card-title">Upload de PDF</h5>
            <div class="upload-area" id="uploadArea">
                <i class="bi bi-cloud-upload" style="font-size: 2rem; color: #6c757d;"></i>
                <p class="mt-2 mb-2">Arraste e solte um arquivo PDF aqui ou clique para selecionar</p>
                <input type="file" id="inputPdf" accept=".pdf" style="display: none;">
                <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('inputPdf').click()">Selecionar PDF</button>
            </div>
            <div id="statusUpload" class="mt-3" style="display: none;"></div>
            <div id="textoExtraido" class="mt-3" style="display: none;">
                <label class="form-label">Texto Extraído:</label>
                <textarea id="textoExtaidoContent" class="form-control" rows="4" readonly></textarea>
            </div>
        </div>
        
        <!-- Seção de Configuração do Prompt -->
        <div class="card p-4 shadow-sm">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="selectCategoria" class="form-label">Categoria</label>
                    <select class="form-select" id="selectCategoria">
                        <option value="geral">Geral</option>
                        <option value="medicina">Medicina</option>
                        <option value="direito">Direito</option>
                        <option value="licitacoes">Licitações</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="selectTipo" class="form-label">Tipo de Resumo</label>
                    <select class="form-select" id="selectTipo">
                        <option value="simples">Simples</option>
                        <option value="analitico">Analítico</option>
                        <option value="critico">Crítico</option>
                        <option value="topicos">Em Tópicos</option>
                        <option value="apresentacao">Para Apresentação</option>
                        <option value="academico">Acadêmico</option>
                    </select>
                </div>
            </div>
            <button id="btnGerar" class="btn btn-primary w-100 mb-3">Gerar Prompt</button>
            <div class="mt-3">
                <label class="form-label">Prompt Gerado:</label>
                <textarea id="outputPrompt" class="form-control" rows="6" readonly></textarea>
            </div>
            <div class="mt-3 d-flex flex-wrap gap-2" id="botoesAcoes" style="display:none;">
                <button id="btnCopiar" class="btn btn-copiar">Copiar Prompt</button>
                <button class="btn btn-gemini" onclick="abrirIA('gemini')">Abrir Gemini</button>
                <button class="btn btn-chatgpt" onclick="abrirIA('chatgpt')">Abrir ChatGPT</button>
                <button class="btn btn-deepseek" onclick="abrirIA('deepseek')">Abrir DeepSeek</button>
                <button class="btn btn-claude" onclick="abrirIA('claude')">Abrir Claude</button>
                <button class="btn btn-perplexity" onclick="abrirIA('perplexity')">Abrir Perplexity</button>
                <button class="btn btn-manus" onclick="abrirIA('manus')">Abrir Manus</button>
            </div>
        </div>
    </div>
    
    <script>
        let textoExtraido = '';
        
        const tiposPorCategoria = {
            'geral': [
                {value: 'simples', text: 'Simples'},
                {value: 'analitico', text: 'Analítico'},
                {value: 'critico', text: 'Crítico'},
                {value: 'topicos', text: 'Em Tópicos'},
                {value: 'apresentacao', text: 'Para Apresentação'},
                {value: 'academico', text: 'Acadêmico'}
            ],
            'medicina': [
                {value: 'clinico', text: 'Clínico'},
                {value: 'cientifico', text: 'Científico'},
                {value: 'prontuario', text: 'Prontuário'}
            ],
            'direito': [
                {value: 'juridico', text: 'Jurídico'},
                {value: 'legislacao', text: 'Legislação'},
                {value: 'jurisprudencia', text: 'Jurisprudência'}
            ],
            'licitacoes': [
                {value: 'edital', text: 'Edital'},
                {value: 'processo', text: 'Processo'},
                {value: 'contrato', text: 'Contrato'}
            ]
        };

        const urlsIA = {
            'gemini': 'https://gemini.google.com/',
            'chatgpt': 'https://chat.openai.com/',
            'deepseek': 'https://chat.deepseek.com/',
            'claude': 'https://claude.ai/',
            'perplexity': 'https://www.perplexity.ai/',
            'manus': 'https://www.manus.im/'
        };

        // Configuração do upload de PDF
        const uploadArea = document.getElementById('uploadArea');
        const inputPdf = document.getElementById('inputPdf');
        const statusUpload = document.getElementById('statusUpload');
        const textoExtraidoDiv = document.getElementById('textoExtraido');
        const textoExtraidoContent = document.getElementById('textoExtaidoContent');

        // Eventos de drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processarPDF(files[0]);
            }
        });

        inputPdf.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                processarPDF(e.target.files[0]);
            }
        });

        async function processarPDF(arquivo) {
            if (!arquivo.name.toLowerCase().endsWith('.pdf')) {
                mostrarStatus('Apenas arquivos PDF são aceitos.', 'danger');
                return;
            }

            mostrarStatus('Processando PDF...', 'info');

            const formData = new FormData();
            formData.append('arquivo', arquivo);

            try {
                const response = await fetch('/upload_pdf', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.sucesso) {
                    textoExtraido = result.texto;
                    textoExtraidoContent.value = result.texto;
                    textoExtraidoDiv.style.display = 'block';
                    mostrarStatus(`PDF "${result.nome_arquivo}" processado com sucesso!`, 'success');
                } else {
                    mostrarStatus(result.erro || 'Erro ao processar PDF', 'danger');
                }
            } catch (error) {
                mostrarStatus('Erro ao enviar arquivo: ' + error.message, 'danger');
            }
        }

        function mostrarStatus(mensagem, tipo) {
            statusUpload.innerHTML = `<div class="alert alert-${tipo}" role="alert">${mensagem}</div>`;
            statusUpload.style.display = 'block';
            
            if (tipo === 'success') {
                setTimeout(() => {
                    statusUpload.style.display = 'none';
                }, 3000);
            }
        }

        document.getElementById('selectCategoria').onchange = function() {
            const categoria = this.value;
            const selectTipo = document.getElementById('selectTipo');
            selectTipo.innerHTML = '';
            
            tiposPorCategoria[categoria].forEach(tipo => {
                const option = document.createElement('option');
                option.value = tipo.value;
                option.textContent = tipo.text;
                selectTipo.appendChild(option);
            });
        };

        document.getElementById('btnGerar').onclick = async function() {
            const categoria = document.getElementById('selectCategoria').value;
            const tipo = document.getElementById('selectTipo').value;
            
            const resp = await fetch('/gerar_prompt', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({categoria, tipo, texto: textoExtraido})
            });
            const json = await resp.json();
            document.getElementById('outputPrompt').value = json.prompt;
            document.getElementById('botoesAcoes').style.display = 'flex';
        };

        document.getElementById('btnCopiar').onclick = function() {
            const textarea = document.getElementById('outputPrompt');
            textarea.select();
            document.execCommand('copy');
            this.textContent = 'Copiado!';
            setTimeout(() => {
                this.textContent = 'Copiar Prompt';
            }, 2000);
        };

        function abrirIA(plataforma) {
            const url = urlsIA[plataforma];
            if (url) {
                window.open(url, '_blank');
            }
        }
    </script>
</body>
</html>